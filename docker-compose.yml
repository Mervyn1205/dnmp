version: "3"
services:
    nginx:
        build: ./nginx
        container_name: docker_nginx
        volumes:
            - ./nginx/fastcgi_params:/etc/nginx/fastcgi_params
            - ./nginx/nginx.conf:/etc/nginx/nginx.conf
            - ./nginx/conf.d:/etc/nginx/conf.d:rw
            - ./data/logs/nginx:/var/log/nginx:rw
            - ~/workspace/www:/var/www/html:rw

    php56:
        container_name: docker_php56
        build:
            context: ./php
            dockerfile: Dockerfile
            args:
                PHP_VERSION: ${PHP56_VERSION}
                PHP_EXTENSIONS: ${PHP56_EXTENSIONS}
                PHP_MEMCACHED_VERSION: ${PHP56_MEMCACHED_VERSION}
        volumes:
            - ./php5.6/php-fpm.d/www.conf:/usr/local/etc/php-fpm.d/www.conf
            - ~/workspace/www:/var/www/html:rw

    php71:
        container_name: docker_php71
        build: ./php7.1
        volumes:
            - ./php7.1/php-fpm.d/www.conf:/usr/local/etc/php-fpm.d/www.conf
            - ~/workspace/www:/var/www/html:rw


    mysql:
        container_name: docker_mysql
        build: ./mysql
        ports:
            - "3306:3306"
        environment :
            MYSQL_ROOT_PASSWORD: 123456
        volumes:
          - ~/data/mysql:/var/lib/mysql
        networks:
            - "backend"
networks:
    backend:
        driver: bridge